<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>My Docs</title>
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify/themes/vue.css" />
</head>
<body>
  <div id="app"></div>

  <!-- Docsify Core -->
  <script src="//cdn.jsdelivr.net/npm/docsify/lib/docsify.min.js"></script>

  <script>
    window.$docsify = {
      name: 'My Docs',
      repo: 'sheik195/docsify',

      plugins: [
        function (hook, vm) {

          hook.afterEach(function (content, next) {

            const path = vm.route.file || 'README.md';
            const apiURL = `https://api.github.com/repos/sheik195/docsify/commits?path=${path}`;

            fetch(apiURL)
              .then(res => res.json())
              .then(commits => {

                let history = "## ğŸ“ Commit History\n\n";

                commits.forEach(c => {
                  history += `
**Author:** ${c.commit.author.name}  
**Date:** ${c.commit.author.date}  
**Message:** ${c.commit.message}  

---`;
                });

                next(history + "\n\n" + content);
              })
              .catch(err => {
                next("## ğŸ“ Commit History\n\nUnable to load commit history.\n\n" + content);
              });
          });
        }
      ]
    }
  </script>

</body>
</html>
